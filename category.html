<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Category</title>
<link rel="stylesheet" href="css/style.css">
</head>

<body>

<!-- HEADER SAME AS INDEX -->
<header>
  <div class="menu-btn" onclick="openMenu()">☰</div>
  <div class="logo">StockNews</div>
  
</header>
  
<!-- MOBILE MENU -->
<div id="mobileMenu" class="mobile-menu">
  <span class="close" onclick="closeMenu()">✕</span>
  <div class="menu-header">
  Stock Edge
  </div>
  
  <a href="index.html">Home</a>
<!-- Accordion Button -->
  <div class="menu-accordion" onclick="toggleCat()">
    News Categories
    <span id="arrow">▼</span>
  </div>

  <!-- Accordion Content -->
  <div id="catMenu" class="submenu">
    <a href="category.html?cat=latest">Latest News</a>
    <a href="category.html?cat=earnings">Earnings</a>
    <a href="category.html?cat=dividend">Dividend</a>
  </div>
</div>

<!-- CATEGORY TITLE BAR -->
<div class="category-title-bar">
  <h2 id="categoryTitle"></h2>
</div>

<!-- NEWS LIST -->
<main id="list"></main>
<div id="pagination" class="pagination"></div>

<!-- FOOTER SAME AS INDEX -->
<footer>
  <div class="footer-links">
    <a href="#">About Us</a>
    <a href="#">Privacy Policy</a>
    <a href="#">Terms & Conditions</a>
    <a href="#">Contact</a>
  </div>
  <div class="footer-bottom">
    © 2025 StockNews. All rights reserved.
  </div>
</footer>

<!-- JS FILES -->
<script src="js/latest.js"></script>
<script src="js/earning.js"></script>
<script src="js/dividend.js"></script>

<script>
/* =========================
   MOBILE MENU
========================= */

function openMenu(){
  document.getElementById("mobileMenu").classList.add("show");
}

function closeMenu(){
  document.getElementById("mobileMenu").classList.remove("show");
}
function toggleCat(){
  const menu = document.getElementById("catMenu");
  const arrow = document.getElementById("arrow");

  if(menu.style.maxHeight){
    menu.style.maxHeight = null;
    arrow.innerText = "▼";
  }else{
    menu.style.maxHeight = menu.scrollHeight + "px";
    arrow.innerText = "▲";
  }
}
  
/* =========================
   CATEGORY TITLE
========================= */
const cat = new URLSearchParams(location.search).get("cat");
const categoryTitle = document.getElementById("categoryTitle");
if(categoryTitle && cat){
  categoryTitle.innerText = cat.charAt(0).toUpperCase() + cat.slice(1) + " News";
}

/* =========================
   DATA SELECTION
========================= */
let data=[];
if(cat==="latest") data=latestNews;
if(cat==="earnings") data=earningNews;
if(cat==="dividend") data=dividendNews;

/* ADD CATEGORY IF MISSING */
data = data.map(n=>({...n, category: n.category || cat.toUpperCase()}));

/* SORT BY DATE */
data.sort((a,b)=>new Date(b.date)-new Date(a.date));

/* =========================
   PAGINATION SETTINGS
========================= */
let currentPage = 1;
const perPage = 10;

function renderPage(page){
  const list = document.getElementById("list");
  const pagination = document.getElementById("pagination");
  list.innerHTML = "";

  const start = (page-1)*perPage;
  const end = start+perPage;

  data.slice(start,end).forEach(n=>{
    list.innerHTML += `
    <div class="news-card" onclick="location.href='${n.link}'">
      <img src="${n.image}" alt="">
      <div class="news-text">
        <div class="news-title">${n.title}</div>
        <div class="news-meta">${n.date} | ${n.category}</div>
        <div class="news-summary">${n.summary}</div>
      </div>
    </div>`;
  });

  renderPagination();
}

function renderPagination(){
  const pagination = document.getElementById("pagination");
  pagination.innerHTML = "";
  const totalPages = Math.ceil(data.length/perPage);

  if(totalPages<=1) return;

  if(currentPage>1) pagination.innerHTML += `<button onclick="goPage(${currentPage-1})">← Prev</button>`;
  pagination.innerHTML += `<span>Page ${currentPage} of ${totalPages}</span>`;
  if(currentPage<totalPages) pagination.innerHTML += `<button onclick="goPage(${currentPage+1})">Next →</button>`;
}

function goPage(page){
  currentPage = page;
  window.scrollTo({top:0, behavior:"smooth"});
  renderPage(currentPage);
}

/* INITIAL RENDER */
renderPage(currentPage);
  
</script>

</body>
</html>

