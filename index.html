
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Stock Market News</title>
<link rel="stylesheet" href="css/style.css">
</head>

<body>

<!-- HEADER -->
<div id="header"></div>

<main>

<section>
  <h2>Latest News</h2>
  <div id="latestNews"></div>
  <a class="view-all" href="category.html?cat=latest">View All</a>
</section>

<section>
  <h2>Earnings Update</h2>
  <div id="earningsNews"></div>
  <a class="view-all" href="category.html?cat=earnings">View All</a>
</section>

<section>
  <h2>Dividend Update</h2>
  <div id="dividendNews"></div>
  <a class="view-all" href="category.html?cat=dividend">View All</a>
</section>

</main>

<!-- FOOTER -->
<div id="footer"></div>

<!-- LOAD HEADER & FOOTER -->
<script>
fetch("/partials/header.html")
  .then(res => res.text())
  .then(data => document.getElementById("header").innerHTML = data);

fetch("/partials/footer.html")
  .then(res => res.text())
  .then(data => document.getElementById("footer").innerHTML = data);
</script>

<!-- DATA FILES -->
<script src="js/latest.js"></script>
<script src="js/earning.js"></script>
<script src="js/dividend.js"></script>

<!-- MENU -->
<script src="/js/menu.js"></script>

<!-- MAIN LOGIC -->
<script>
/* =========================
   AUTO NEW BADGE
========================= */
function isNew(dateStr){
  const newsDate = new Date(dateStr);
  const now = new Date();
  const diffHours = (now - newsDate) / (1000 * 60 * 60);
  return diffHours <= 24;
}

/* =========================
   RENDER FUNCTION
========================= */
function render(id, data, limit){
  const box = document.getElementById(id);
  if(!box) return;

  box.innerHTML = "";

  data.slice(0, limit).forEach(n=>{
    const newBadge = isNew(n.date)
      ? `<span class="new-badge">NEW</span>`
      : "";

    box.innerHTML += `
    <div class="news-card" onclick="location.href='${n.link}'">
      <img src="${n.image}" alt="">
      <div class="news-text">
        <div class="news-title">
          ${newBadge}${n.title}
        </div>
        <div class="news-meta">${n.date} | ${n.category}</div>
        <div class="news-summary">${n.summary}</div>
      </div>
    </div>`;
  });
}

/* =========================
   RENDER ALL NEWS
========================= */
render("latestNews", latestNews, 10);
render("earningsNews", earningNews, 5);
render("dividendNews", dividendNews, 5);
</script>

</body>
</html>
